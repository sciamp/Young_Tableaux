defstruct (ydiagram (rows));

new_ydiagram_safe (l) := block (
  yd : new (ydiagram (sort (l, 'orderlessp))),
  return (yd));

ydiagramp (d) := listp (d@rows) and d@rows = sort (d@rows, 'orderlessp);